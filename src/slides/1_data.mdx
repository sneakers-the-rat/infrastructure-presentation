import { Dataset } from '../components/p2p/dataset'
import { Peer } from '../components/p2p/peer'
import Swarm from '../components/p2p/swarm'
import { Heading, Box, Text, Image, Grid, Quote, Appear } from 'spectacle'
import Paper from '@material-ui/core/Paper'
import PirateBay from '../img/piratebay.png'
import Card from '@material-ui/core/Card';
import CardContent from '@material-ui/core/CardContent';
import Button from '@material-ui/core/Button';
import Typography from '@material-ui/core/Typography';
import VerticalLinearStepper from '../components/vertical_stepper'
import FederatedStack from '../img/federated_db_stack.png'
import FederatedLinks from '../img/federated_db_links.png'
import Federation1 from '../img/federation_1-01.svg'
import SvgAnimator from '../components/svg_animator';
import anime from 'animejs'
import Federation from '../components/p2p/federation'

import funky from 'react-syntax-highlighter/dist/cjs/styles/prism/funky'

# Shared Data

(title slide)

Notes: notes!
* simplifying standardization
* peer to peer systems
* federated databases

---


<Heading marginLeft={'0px'} textAlign={'left'}>
  Accessible Data Standardization
</Heading>
<Text fontSize={30} fontFamily={'monospace'} style={{ marginBottom: '12px' }}>
  To start, we need our data to be FAIR... but that's still really hard!
</Text>
<Box width={4 / 9}>
  (link to example of ONice conversion with really brief description of the approach)
  (add annotation to diagram that the outlines are a schema/ontology and introduce that concept)
</Box>

<svg width={1920} height={1080} className={'svg-fill'}>
  <Dataset
      name="data.exe"
      cols={[
        { name: 'apple', size: 3 },
        { name: 'banana', size: 5 },
        { name: 'peanut', size: 6 },
        { name: 'walrus', size: 2 },
        { name: 'fear', size: 4 },
      ]}
      position={[1750, 200]}
      orientation={90}
      scatter={{
        x: { scale: 30, lambda: 0.2, offset: 0 },
        y: { scale: 50, lambda: 0.5, offset: 50 },
        rotate: true,
      }}
      scale={2}
      outlines={true}
  />
</svg>

---
# How to share?

Once we've got our data standardized, now what?

Now, we would find some centralized server to upload to...


<svg width={1920} height={1080} className={'svg-fill'} id={"svg-root"}>
  <Swarm
      position={[500,600]}
      radius={300}
      name={'swarm'}
      peers={{
        scale: 2,
        names: ['jonny1', 'rumbly1', 'santi1'],
        datasets:{
          n_range: [2,5],
          col_range:[3,6],
          size_range:[2,6],
          scale:0.01
        }}}
      centralized={true}
      server={{
        name: 'servy',
        upload: 5,
        download: 5,
        datasetAngle:120
      }}
  />
</svg>

<Appear>
<svg left={1920/2} width={1920/2} height={1080} className={'svg-fill'} id={"svg-root"}>
  <Swarm
      position={[250,600]}
      radius={300}
      name={'swarm'}
      peers={{
        scale: 2,
        names: ['jonny2', 'rumbly2', 'santi2'],
        datasets:{
          n_range: [2,5],
          col_range:[3,6],
          size_range:[2,6],
          scale:0.01
        }}}
  />
</svg>
</Appear>


---

<Heading marginLeft={'0px'} textAlign={'left'}>P2P</Heading>

<Box width={3/7}>
<Text fontFamily={'monospace'} style={{marginBottom:"4em"}} fontSize={"32px"}>
  What i will tell u now u will never believe
</Text>
  <Text fontFamily={'monospace'} fontWeight={'bold'} style={{marginBottom:"3em", color: "#ff0000", filter: "drop-shadow(30px 30px 0px #CCCCCC"}}>
  in a p2p system, everyone is the server.
</Text>
  <Text fontFamily={'monospace'}>
    this is why pirates curate the largest cultural archives
    that have ever existed
  </Text>
  <Text fontFamily={'monospace'} fontSize={"32px"}>
  (pick your metric: completeness, availability,
  size, community involvement, bandwidth usage, ...)
  </Text>
</Box>

<svg width={1920} height={1080} className={'svg-fill'} id={"svg-root"}>
  <Swarm
      position={[1400,500]}
      radius={350}
      name={'swarm'}
      peers={{
        scale: 2,
        names: ['jonny', 'rumbly', 'santi','tito','timothy', 'apple', 'banana', 'kiwi', 'watermelon', 'macarena'],
        datasets:{
          n_range: [2,5],
          col_range:[3,6],
          size_range:[2,6],
          scale:0.01
        }}}
  />
</svg>

---

# Comparison

comparison of server architecture and p2p quantitatively.

Notes: popup with more info

That p2p system is literally the most basic one. extend it in a bunch of ways

* Versioning
* Obligate Peers - making it always at least as fast as an existing system and integrating with whatever databases already exist

---


# Databases Are Political

So far we have one type of data format and one swarm of peers. so now we just need to get everybody
on the same format and swarm right?

noooo

If we pay attention to the people who study these things...

<Box width={2/3} marginLeft={"auto"} marginRight={"auto"}>
  <Card elevation={1}>
    <CardContent>
      <Quote fontSize={36}>
        Participants describe the individual sequence database
        systems as if they were shadows, poor representations of a
        widely-agreed-upon ideal. [...] Instead, <strong>each decision about the implementation of a particular
        database system plants a stake for a community boundary.</strong>
        The databases are not so much imperfect copies of an ideal as
        they are arguments about what the ideal Database should be.
        <br/><br/>
        In the end, however, the system was so tailored to a specific
        set of research questions that the collection of data,
        the set of tools, and even the social organization of the
        project had to be significantly changed. ...
        <br/><br/>While the database development projects had begun by working
        together, in the end they were unable to collaborate. <strong>The system
        that was supposed to tie these groups together could not be
        shielded from the controversies that formed the boundaries between
        the communities of practice.</strong>
      </Quote>
      <Text fontSize={30}>-Bietz & Lee (2009)
        <Link fontSize={30} href={"https://doi.org/10.1007/978-1-84882-854-4_15"}>
          "Collaboration in Metagenomics"</Link></Text>
    </CardContent>
  </Card>
</Box>


---


<SvgAnimator
    svgUrl={Federation1}
    steps={[
      [
        {
          targets: '#federation-1 '+'#peer_1 *',
          opacity: [0, 1],
          duration: anime.random(500, 1000),
          delay: anime.random(0, 200),
          easing: 'easeInOutQuad',
          loop: false
        },
        {
          targets: '#federation-1 '+'#peer_2 *',
          opacity: [0, 1],
          duration: anime.random(500, 1000),
          delay: anime.random(0, 200),
          easing: 'easeInOutCirc',
          loop: false
        },
        {
          targets: '#federation-1 '+'#peer_outlines *',
          opacity: [0, 1],
          duration: anime.random(500, 1000),
          delay: anime.random(0, 200),
          easing: 'easeInOutCirc',
          loop: false
        }
      ],
      [
        {
          targets: '#federation-1 '+'#call *',
          opacity: [0, 1],
          duration: anime.random(500, 1000),
          delay: anime.random(0, 200),
          easing: 'easeInOutCirc',
          loop: false
        }
      ],
      [
        {
          targets: '#federation-1 '+'#phone-3',
          translateX: ["10px", 0],
          translateY: ["-10px", 0],
          duration: 100,
          delay: 0,
          easing: 'easeInOutQuad',
          direction: 'alternate',
          loop: 5
        }
      ],[
        {
          targets: "#federation-1 #call_1 polyline",
          strokeDashoffset: [anime.setDashoffset, 0],
          duration: 1000,
          easing: 'easeInQuad'
        },
        {
          targets: "#federation-1 #call_1 #phone, #phone-2",
          translateX: ["10px", 0],
          translateY: ["-10px", 0],
          duration: 100,
          delay: 0,
          easing: 'easeInOutQuad',
          direction: 'alternate',
          loop: 5
        }
      ],
        [
          {
            targets: "#federation-1 #call_1 *",
            opacity: [1,0]
          }
        ],
      [
          {
            target: "#federation-1 #fedlayer *",
            scale: [0, 1],
            duration: 500,
            delay: 0,
            easing: 'easeInQuad',
            loop: false
          }
        ],
      [
        {
          targets: '#federation-1 #call_2 *',
          opacity: [0,1],
          duration: 500,
          delay:0 ,
          easing: 'easeInOutQuad',
          loop: false
        }
        ]]}
    id={'federation-1'}
/>

Notes: federation notes
* Design autonomy - users control implementation
* Loosely Coupled - users control federation (cite sheth 1990)


---

zoomed out federation slide showing the example of multiple labs/institutes/formats federating together
with incomplete linkage.

<Federation/>

---

brief slide of caveats

* not new! lots of previous times been proposed
* need other stuff - total control over federation, data privacy,
  versioning, etc.
  - ipfs does this! libgen is on ipfs!

---

Brief nod to frontend diagrammatically -- the 'third layer' of the user actually executing a query
say we're going to get back to that when we talk about the community structure.




---


